import discord
import os
import re
import threading
from flask import Flask, jsonify, render_template
from datetime import datetime, timezone, timedelta

# -------------------------------------
# 설정
# -------------------------------------
DISCORD_TOKEN = os.environ.get('DISCORD_TOKEN')
TARGET_CHANNEL_ID = int(os.environ.get('TARGET_CHANNEL_ID'))

# ★★★ 2번 컴퓨터 UUID 오타를 수정한 최종 목록 ★★★
UUID_MAP = {
    "B6254D56-1931-8E9A-6F2C-C413BCA4F6CB": "1번 컴퓨터",
    "00F54D56-3471-F7DA-19A0-25962FD3EDD4": "2번 컴퓨터", # 오타 수정 완료
    "698A4D56-6628-2370-1786-F01F6FB8E011": "3번 컴퓨터", "758B4D56-184F-DCCE-BA13-5125C618E676": "4번 컴퓨터",
    "DF1F4D56-5DC5-8F54-464D-64A208A271FA": "5번 컴퓨터", "C6144D56-3194-835A-DBC7-220B047B5C38": "6번 컴퓨터",
    "AD164D56-9697-F145-06F9-234427A81542": "7번 컴퓨터", "D65F4D56-1EF8-F9E0-4D09-5EAB7DD1FF23": "8번 컴퓨터",
    "8F3D4D56-F7B9-2BF2-9759-BC51850C4FB5": "9번 컴퓨터", "38604D56-CA2C-9EAB-EE8C-A5027CA9DF1F": "10번 컴퓨터",
    "38D04D56-D069-560A-C0F2-8134C084F51A": "11번 컴퓨터", "3ECC4D56-5665-E689-A421-6A75E2798EA9": "12번 컴퓨터",
    "F4744D56-1E66-CFDC-E512-A24802575046": "13번 컴퓨터", "F26D4D56-3C10-BB01-0A3F-986608EFF8EB": "14번 컴퓨터",
    "EF554D56-02FA-6B27-D7DF-E0035735F46F": "15번 컴퓨터", "40F54D56-F32B-5907-EAB9-ECDE4575790F": "16번 컴퓨터",
    "4AE64D56-A83F-5E42-ECBC-013ED8481177": "17번 컴퓨터", "F9624D56-FC82-5E28-9B63-4E7E2A7974EE": "18번 컴퓨터",
    "1E234D56-F6D0-505D-D45A-4C50C5927269": "19번 컴퓨터", "04E44D56-E467-0627-2F09-BF4A717066CD": "20번 컴퓨터",
    "FFEA4D56-A459-CAA5-9533-AA1E22B6DA5D": "21번 컴퓨터", "26C94D56-5A33-763F-9A0B-5F4CDDDDC7EC": "22번 컴퓨터",
    "17104D56-DDFE-8D21-449B-C33B19A927F3": "23번 컴퓨터", "D6A84D56-8450-D574-938C-ED8C16A77DD4": "24번 컴퓨터",
    "949E4D56-09CB-B9CE-DBEC-D0FC68A4BC75": "25번 컴퓨터", "D1D64D56-F555-9DCA-3925-4DD0B1A3712E": "26번 컴퓨터",
    "CFA94D56-676A-E605-ECF2-112CDEA03B97": "27번 컴퓨터", "78B64D56-D806-067C-D546-7FABCEA4A3A4": "28번 컴퓨터",
    "7F0F4D56-9C6F-997F-9A6A-161C339ADA9A": "29번 컴퓨터", "31FF4D56-3181-17BD-7809-74B11C1876F9": "30번 컴퓨터",
    "8E544D56-FF26-B51A-6EA4-F3B0F3C1ED3F": "31번 컴퓨터", "136D4D56-75C7-3E35-3265-82E06F38590B": "32번 컴퓨터",
    "FB4B4D56-BCAD-A688-3BBB-3852183AF890": "33번 컴퓨터", "8DA94D56-ED63-A920-9271-F07D95ADC724": "34번 컴퓨터",
    "D8F84D56-7C5C-DD5A-B83F-FF721A44631D": "35번 컴퓨터", "89084D56-8154-DD3A-7309-730605E29ADE": "36번 컴퓨터",
    "CB814D56-26FA-C719-88A3-5A9352ADDD18": "37번 컴퓨터", "EEE74D56-EC3D-519E-65D5-0542F2943FB7": "38번 컴퓨터",
    "C1624D56-4416-42C0-A00F-921FC1561D91": "39번 컴퓨터", "DCF64D56-B2D6-A192-600D-13663D8FE5F2": "40번 컴퓨터",
    "4B9F4D56-5555-A0F4-1A02-ECB5D4963487": "41번 컴퓨터", "F2CC4D56-3B73-EC7F-CF91-B61E41F68992": "42번 컴퓨터",
    "E0624D56-2283-3A43-B01B-A76432FDE910": "43번 컴퓨터", "57D84D56-5D42-A290-2247-47AAEEC47A0C": "44번 컴퓨터",
    "DA884D56-501E-D0B7-690B-08F44F8C61A6": "45번 컴퓨터", "598C4D56-5329-B19C-E606-DC4A20304702": "46번 컴퓨터",
    "D8224D56-6ECE-AE1D-7CB1-86DFF778B508": "47번 컴퓨터", "9CC74D56-C15B-DE2D-79C7-68F0E23E927E": "48번 컴퓨터",
    "F05B4D56-C2A1-0826-BD7A-777EAC987CEA": "49번 컴퓨터", "0A974D56-C2BF-965B-F9BF-0AA60716C96B": "50번 컴퓨터",
    "11424D56-8BBF-E8F0-6AA0-BA1B6738A31B": "51번 컴퓨터", "EE554D56-917C-9C06-A515-27DE7FB7DAB1": "52번 컴퓨터",
    "28354D56-1929-2BE0-78DC-02847872655B": "53번 컴퓨터", "CC224D56-33E6-AC79-75BF-0FFD85410C16": "54번 컴퓨터",
    "14F64D56-34C5-F375-4F34-0EEA9DB51071": "55번 컴퓨터", "DCDA4D56-5A60-964F-F5F9-C513CE621170": "56번 컴퓨터",
    "E2854D56-CDF8-0C32-4A80-A3CAC58AA299": "57번 컴퓨터", "392A4D56-EF74-8BFF-11EE-1A5FC500AFD6": "58번 컴퓨터",
    "96FC4D56-48D0-2955-0555-FE6A61B9016B": "59번 컴퓨터", "2E5A4D56-B89E-0014-B656-B2528E1D70C6": "60번 컴퓨터",
    "DA584D56-5A32-52F2-65CC-C345DB5C4CFB": "61번 컴
